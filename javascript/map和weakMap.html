<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>

      // 1. 键的类型不同
      // Map：键可以是任意类型（对象、基本类型都可以）。
      // WeakMap：键只能是对象（且不能是 null），不能用基本类型（如字符串、数字）作为键。
      // 2. 垃圾回收机制不同
      // Map：对键和值都是强引用。只要 Map 存在，键和值就不会被垃圾回收。
      // WeakMap：对“键”是弱引用。如果没有其他变量引用这个键对象，键值对会被自动垃圾回收（值也会一起被回收）。
      // 3. 可枚举性不同
      // Map：可以使用 forEach、for...of、keys()、values()、entries() 等方法遍历所有键值对。
      // WeakMap：不可遍历，没有 size 属性，也没有 keys/values/entries/forEach 等方法。只能通过 set/get/has/delete 操作。
      // 4. 应用场景不同
      // Map：适合需要频繁遍历、统计、管理各种类型键值对的场景。
      // WeakMap：适合给对象“打补丁”或做私有数据存储，不影响对象的垃圾回收，常用于实现对象的“弱关联”。

      const map = new Map();
      // set get delete clear has
      // map.set("a", "a");
      // map.set("b", "b");
      // map.set("c", "c");
      // map.set({ name: 'jack' }, { age: 22 });
      //   const aVal = map.get("a");
      //   console.log(aVal);
      //   console.log(map.has("a"));
      //   console.log(map.delete("a"));
      //   map.clear();

      // for of ,  keys , entries, forEach
      // for (let [key, val] of map) {
      //   console.log(key, val);
      // }
      // for (let key of map.keys()) {
      //   console.log(key, map.get(key));
      // }
      // for (let [key, val] of map.entries()) {
      //   console.log(key, val);
      // }
      // map.forEach((val, key) => {
      //   console.log(key, val);
      // });
      // NaN作为map-key
      map.set(NaN, "NaN1");
      map.set(NaN, "NaN2");
      console.log("key NaN", map.get(NaN));
      // JSON.stringify
      const jsonString = JSON.stringify(map);
      console.log("jsonstringify", jsonString); // {}
      // 设置对象属性 
      map["x1"] = "x1";
      map["x2"] = "x2";
      console.log(map);
      console.log(map.get("x1")); // undefined
      console.log(map.get("x2")); // undefined
      console.log(map["x1"]); // x1

      const objectKey = { id: 1 };
      map.set(objectKey, { key: 1 });
      console.log(map.get(objectKey));

      // WeakMap   键是弱引用的。其键必须是对象，而值可以是任意的
      // 使用场景一般是对象额外关联一些数据 比如dom关联某些数据 但是不想处理数据回收
      // delete get set has
      const weakMap = new WeakMap();
      weakMap.set("a", "a");
    </script>
  </body>
</html>
